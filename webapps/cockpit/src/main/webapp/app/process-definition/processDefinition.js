'use strict';

angular.module('process.definition', [])

.config(['$routeProvider', function ($routeProvider) {
  $routeProvider.when('/process-definition/:processDefinitionId', {
    templateUrl:'app/process-definition/process-definition.html',
    controller: 'ProcessDefinitionCtrl'
  });
}])

.controller('ProcessDefinitionCtrl', ['$scope', 'ProcessDefinitionResource', function($scope, ProcessDefinitionResource) {
  var stubProcessDefinitionXmlDto = {"id":"fox-invoice_en:1:294300d8-7c24-11e2-96a4-001f3b473707","bpmn20_xml":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:activiti=\"http://activiti.org/bpmn\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:signavio=\"http://www.signavio.com\" xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\" id=\"sid-0b0aaa25-3baf-4875-9d7a-0907d599a9ef\" exporter=\"Signavio Process Editor, http://www.signavio.com\" exporterVersion=\"5.4.1\" targetNamespace=\"http://www.omg.org/spec/BPMN/20100524/MODEL\">\n  <dataStore id=\"FinancialAccountingSystem\" isUnlimited=\"false\" name=\"Financial Accounting System\">\n    <dataState id=\"DataState_1\"/>\n  </dataStore>\n  <message id=\"foxMessage_en\" name=\"foxMessage_en\"/>\n  <collaboration id=\"collaboration_3\">\n    <participant id=\"Process_Engine_1\" name=\"invoice receipt (fox)\" processRef=\"fox-invoice_en\"/>\n  </collaboration>\n  <process id=\"fox-invoice_en\" name=\"invoice receipt (fox)\" isExecutable=\"true\">\n    <laneSet id=\"laneSet_5\">\n      <lane id=\"Approver\" name=\"approver\">\n        <flowNodeRef>approveInvoice</flowNodeRef>\n        <flowNodeRef>invoice_approved</flowNodeRef>\n      </lane>\n      <lane id=\"teamAssistant\" name=\"team assistant\">\n        <flowNodeRef>invoiceReceived</flowNodeRef>\n        <flowNodeRef>reviewInvoice</flowNodeRef>\n        <flowNodeRef>reviewSuccessful_gw</flowNodeRef>\n        <flowNodeRef>invoiceNotProcessed</flowNodeRef>\n        <flowNodeRef>assignApprover</flowNodeRef>\n      </lane>\n      <lane id=\"Accountant\" name=\"accountant\">\n        <flowNodeRef>saveInvoiceToSVN</flowNodeRef>\n        <flowNodeRef>prepareBankTransfer</flowNodeRef>\n        <flowNodeRef>invoiceProcessed</flowNodeRef>\n      </lane>\n    </laneSet>\n    <userTask id=\"approveInvoice\" activiti:expression=\"${true}\" name=\"approve invoice\">\n      <incoming>sequenceFlow_178</incoming>\n      <incoming>reviewSuccessful</incoming>\n      <outgoing>sequenceFlow_180</outgoing>\n    </userTask>\n    <exclusiveGateway id=\"invoice_approved\" name=\"invoice approved?\" gatewayDirection=\"Diverging\">\n      <incoming>sequenceFlow_180</incoming>\n      <outgoing>invoiceNotApproved</outgoing>\n      <outgoing>invoiceApproved</outgoing>\n    </exclusiveGateway>\n    <startEvent id=\"invoiceReceived\" name=\"invoice received\">\n      <outgoing>sequenceFlow_187</outgoing>\n      <messageEventDefinition id=\"messageEventDefinition_30\" messageRef=\"foxMessage_en\"/>\n    </startEvent>\n    <userTask id=\"reviewInvoice\" activiti:expression=\"${true}\" name=\"review invoice\">\n      <incoming>invoiceNotApproved</incoming>\n      <outgoing>sequenceFlow_183</outgoing>\n    </userTask>\n    <exclusiveGateway id=\"reviewSuccessful_gw\" name=\"review successful?\" gatewayDirection=\"Diverging\">\n      <incoming>sequenceFlow_183</incoming>\n      <outgoing>reviewNotSuccessful</outgoing>\n      <outgoing>reviewSuccessful</outgoing>\n    </exclusiveGateway>\n    <endEvent id=\"invoiceNotProcessed\" name=\"invoice not processed\">\n      <incoming>reviewNotSuccessful</incoming>\n    </endEvent>\n    <serviceTask id=\"saveInvoiceToSVN\" activiti:expression=\"${true}\" name=\"save invoice to SVN\">\n      <incoming>sequenceFlow_179</incoming>\n      <outgoing>SequenceFlow_1</outgoing>\n    </serviceTask>\n    <userTask id=\"prepareBankTransfer\" activiti:expression=\"${true}\" name=\"prepare bank transfer\">\n      <incoming>invoiceApproved</incoming>\n      <outgoing>sequenceFlow_179</outgoing>\n    </userTask>\n    <sequenceFlow id=\"invoiceNotApproved\" name=\"no\" isImmediate=\"true\" sourceRef=\"invoice_approved\" targetRef=\"reviewInvoice\">\n      <conditionExpression xsi:type=\"tFormalExpression\" id=\"conditionExpression_56\">${!approved}</conditionExpression>\n    </sequenceFlow>\n    <sequenceFlow id=\"sequenceFlow_180\" isImmediate=\"true\" sourceRef=\"approveInvoice\" targetRef=\"invoice_approved\"/>\n    <sequenceFlow id=\"sequenceFlow_183\" isImmediate=\"true\" sourceRef=\"reviewInvoice\" targetRef=\"reviewSuccessful_gw\"/>\n    <sequenceFlow id=\"sequenceFlow_179\" isImmediate=\"true\" sourceRef=\"prepareBankTransfer\" targetRef=\"saveInvoiceToSVN\"/>\n    <sequenceFlow id=\"SequenceFlow_1\" isImmediate=\"true\" sourceRef=\"saveInvoiceToSVN\" targetRef=\"invoiceProcessed\"/>\n    <sequenceFlow id=\"invoiceApproved\" name=\"yes\" isImmediate=\"true\" sourceRef=\"invoice_approved\" targetRef=\"prepareBankTransfer\">\n      <conditionExpression xsi:type=\"tFormalExpression\" id=\"conditionExpression_63\">${approved}</conditionExpression>\n    </sequenceFlow>\n    <sequenceFlow id=\"reviewNotSuccessful\" name=\"no\" isImmediate=\"true\" sourceRef=\"reviewSuccessful_gw\" targetRef=\"invoiceNotProcessed\">\n      <conditionExpression xsi:type=\"tFormalExpression\" id=\"conditionExpression_65\">${clarified.equals('no')}</conditionExpression>\n    </sequenceFlow>\n    <sequenceFlow id=\"sequenceFlow_187\" isImmediate=\"true\" sourceRef=\"invoiceReceived\" targetRef=\"assignApprover\"/>\n    <sequenceFlow id=\"reviewSuccessful\" name=\"yes\" isImmediate=\"true\" sourceRef=\"reviewSuccessful_gw\" targetRef=\"approveInvoice\">\n      <conditionExpression xsi:type=\"tFormalExpression\" id=\"conditionExpression_68\">${clarified.equals('yes')}</conditionExpression>\n    </sequenceFlow>\n    <dataStoreReference id=\"DataStoreReference_1\" name=\"Financial Accounting System\" dataStoreRef=\"FinancialAccountingSystem\"/>\n    <endEvent id=\"invoiceProcessed\" name=\"invoice processed\">\n      <incoming>SequenceFlow_1</incoming>\n    </endEvent>\n    <userTask id=\"assignApprover\" activiti:assignee=\"kermit\" activiti:formKey=\"assignApprover\" name=\"assign approver\">\n      <incoming>sequenceFlow_187</incoming>\n      <outgoing>sequenceFlow_178</outgoing>\n    </userTask>\n    <sequenceFlow id=\"sequenceFlow_178\" isImmediate=\"true\" sourceRef=\"assignApprover\" targetRef=\"approveInvoice\"/>\n    <association id=\"Association_1\" sourceRef=\"DataStoreReference_1\" targetRef=\"prepareBankTransfer\"/>\n  </process>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_73\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_73\" bpmnElement=\"collaboration_3\">\n      <bpmndi:BPMNShape id=\"Process_Engine_1_gui\" bpmnElement=\"Process_Engine_1\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"488.0\" width=\"1126.0\" x=\"0.0\" y=\"0.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Freigebender_105_gui\" bpmnElement=\"Approver\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"161.0\" width=\"1096.0\" x=\"30.0\" y=\"183.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Team-Assistenz_110_gui\" bpmnElement=\"teamAssistant\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"183.0\" width=\"1096.0\" x=\"30.0\" y=\"0.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Buchhaltung_119_gui\" bpmnElement=\"Accountant\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"144.0\" width=\"1096.0\" x=\"30.0\" y=\"344.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Rechnung_freigeben_125_gui\" bpmnElement=\"approveInvoice\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"80.0\" width=\"100.0\" x=\"353.0\" y=\"225.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Freigabe_erfolgt__131_gui\" bpmnElement=\"invoice_approved\" isHorizontal=\"true\" isMarkerVisible=\"true\">\n        <omgdc:Bounds height=\"40.0\" width=\"40.0\" x=\"488.0\" y=\"245.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Rechnung_eingegangen_138_gui\" bpmnElement=\"invoiceReceived\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"28.0\" width=\"28.0\" x=\"112.0\" y=\"78.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Freigebenden_zuordnen_143_gui\" bpmnElement=\"assignApprover\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"80.0\" width=\"100.0\" x=\"180.0\" y=\"52.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Rechnung_kl_ren_148_gui\" bpmnElement=\"reviewInvoice\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"80.0\" width=\"100.0\" x=\"548.0\" y=\"52.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Kl_rung_erfolgreich__153_gui\" bpmnElement=\"reviewSuccessful_gw\" isHorizontal=\"true\" isMarkerVisible=\"true\">\n        <omgdc:Bounds height=\"40.0\" width=\"40.0\" x=\"693.0\" y=\"72.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"endEvent_165_gui\" bpmnElement=\"invoiceNotProcessed\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"28.0\" width=\"28.0\" x=\"923.0\" y=\"78.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"PDF_aus_SVN_entfernen_160_gui\" bpmnElement=\"saveInvoiceToSVN\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"80.0\" width=\"100.0\" x=\"780.0\" y=\"385.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"zberweisung_vorbereiten_169_gui\" bpmnElement=\"prepareBankTransfer\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"80.0\" width=\"100.0\" x=\"638.0\" y=\"385.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Rechnungseingang_abgearbeitet_174_gui\" bpmnElement=\"invoiceProcessed\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"28.0\" width=\"28.0\" x=\"940.0\" y=\"411.0\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"DataStoreReference_1_gui\" bpmnElement=\"DataStoreReference_1\" isHorizontal=\"true\">\n        <omgdc:Bounds height=\"61.173\" width=\"63.001\" x=\"503.4995\" y=\"405.4135\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"Nein_182_gui\" bpmnElement=\"invoiceNotApproved\" sourceElement=\"Freigabe_erfolgt__131_gui\" targetElement=\"Rechnung_kl_ren_148_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"508.0\" y=\"245.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"508.0\" y=\"92.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"548.0\" y=\"92.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"sequenceFlow_180_gui\" bpmnElement=\"sequenceFlow_180\" sourceElement=\"Rechnung_freigeben_125_gui\" targetElement=\"Freigabe_erfolgt__131_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"453.0\" y=\"265.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"488.0\" y=\"265.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"sequenceFlow_183_gui\" bpmnElement=\"sequenceFlow_183\" sourceElement=\"Rechnung_kl_ren_148_gui\" targetElement=\"Kl_rung_erfolgreich__153_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"648.0\" y=\"92.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"693.0\" y=\"92.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"sequenceFlow_179_gui\" bpmnElement=\"sequenceFlow_179\" sourceElement=\"zberweisung_vorbereiten_169_gui\" targetElement=\"PDF_aus_SVN_entfernen_160_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"738.0\" y=\"425.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"780.0\" y=\"425.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"sequenceFlow_178_gui\" bpmnElement=\"sequenceFlow_178\" sourceElement=\"Freigebenden_zuordnen_143_gui\" targetElement=\"Rechnung_freigeben_125_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"280.0\" y=\"92.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"310.0\" y=\"92.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"310.0\" y=\"265.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"353.0\" y=\"265.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"Association_1_gui\" bpmnElement=\"Association_1\" sourceElement=\"DataStoreReference_1_gui\" targetElement=\"zberweisung_vorbereiten_169_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"566.0\" y=\"433.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"638.0\" y=\"425.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1_gui\" bpmnElement=\"SequenceFlow_1\" sourceElement=\"PDF_aus_SVN_entfernen_160_gui\" targetElement=\"Rechnungseingang_abgearbeitet_174_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"880.0\" y=\"425.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"940.0\" y=\"425.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"Ja_181_gui\" bpmnElement=\"invoiceApproved\" sourceElement=\"Freigabe_erfolgt__131_gui\" targetElement=\"zberweisung_vorbereiten_169_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"528.0\" y=\"265.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"587.0\" y=\"265.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"587.0\" y=\"425.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"638.0\" y=\"425.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"nein_185_gui\" bpmnElement=\"reviewNotSuccessful\" sourceElement=\"Kl_rung_erfolgreich__153_gui\" targetElement=\"endEvent_165_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"733.0\" y=\"92.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"923.0\" y=\"92.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"sequenceFlow_187_gui\" bpmnElement=\"sequenceFlow_187\" sourceElement=\"Rechnung_eingegangen_138_gui\" targetElement=\"Freigebenden_zuordnen_143_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"140.0\" y=\"92.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"180.0\" y=\"92.0\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"ja_186_gui\" bpmnElement=\"reviewSuccessful\" sourceElement=\"Kl_rung_erfolgreich__153_gui\" targetElement=\"Rechnung_freigeben_125_gui\">\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"713.0\" y=\"72.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"713.0\" y=\"35.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"403.0\" y=\"35.0\"/>\n        <omgdi:waypoint xsi:type=\"omgdc:Point\" x=\"403.0\" y=\"225.0\"/>\n      </bpmndi:BPMNEdge>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</definitions>"};

  $scope.processDiagramXml = stubProcessDefinitionXmlDto;

}]);